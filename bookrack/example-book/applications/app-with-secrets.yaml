# Example: Application with Vault secret integration
# Shows how to inject secrets from HashiCorp Vault

name: app-with-secrets

image:
  name: myapp
  tag: latest
  pullPolicy: Always

replicas: 1

ports:
  - name: http
    containerPort: 8080
    protocol: TCP

service:
  enabled: true
  type: ClusterIP
  ports:
    - name: http
      port: 80
      targetPort: http

# Environment variables that will use secrets from Vault
env:
  - name: DATABASE_URL
    valueFrom:
      secretKeyRef:
        name: app-db-credentials
        key: database_url
  - name: API_KEY
    valueFrom:
      secretKeyRef:
        name: app-api-keys
        key: api_key

# Vault integration using kaster-vault trinket
vault:
  # Database credentials secret
  app-db-credentials:
    path: secret/data/production/database
    outputType: secret
    keys:
      - database_url
      - username
      - password

  # API keys secret
  app-api-keys:
    path: secret/data/production/api-keys
    outputType: secret
    keys:
      - api_key
      - webhook_secret

# Health checks
livenessProbe:
  enabled: true
  httpGet:
    path: /health
    port: http

readinessProbe:
  enabled: true
  httpGet:
    path: /ready
    port: http
